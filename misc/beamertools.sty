\RequirePackage{calc}
\RequirePackage{xkeyval}
\newlength{\@length}

% Define the keys for the doublecolumnframe (dcl)
% Remember: \define@cmdkey[prefix]{family}[mp]{key}   [default]{function}
\define@cmdkey[udp]{dcf}{title}{}%    title of the frame
\define@cmdkey[udp]{dcf}{wp}{}% width percentage

\presetkeys[udp]{dcf}{title=,wp=0.5}{}

\newcommand{\doublecolumnframe}[3][]{%
\setkeys[udp]{dcf}{#1}
\begin{frame}{\cmdudp@dcf@title}%
  \begin{columns}
    \begin{column}{\cmdudp@dcf@wp\linewidth}%
    #2%
    \end{column}%
    \hfill%
    \setlength{\@length}{\linewidth-\cmdudp@dcf@wp\linewidth}%
    \begin{column}{\@length}%
    #3%
    \end{column}%
  \end{columns}%
\end{frame}%
}


% Define the keys for the varblock (vb)
% Remember: \define@cmdkey[prefix]{family}[mp]{key}   [default]{function}
\define@cmdkey[udp]{vb}{titlebg}{}% color for title bg
\define@cmdkey[udp]{vb}{titlefg}{}% color for title fg
\define@cmdkey[udp]{vb}{bodybg}{}% color for body bg
\define@cmdkey[udp]{vb}{bodyfg}{}% color for body fg
\define@cmdkey[udp]{vb}{width}{}% block width
\presetkeys[udp]{vb}{titlebg=structure.fg!75!black,titlefg=white,bodybg=block title.bg!10!bg,bodyfg=black,width=\textwidth}{}

% Variable block
\newenvironment<>{varblock}[2][]{%
\setkeys[udp]{vb}{#1}
  \begingroup
  \setbeamercolor{block title}{bg=\cmdudp@vb@titlebg,fg=\cmdudp@vb@titlefg}%bg=background, fg= foreground
  \setbeamercolor{block body}{bg=\cmdudp@vb@bodybg,fg=\cmdudp@vb@bodyfg}%bg=background, fg= foreground
  \begin{minipage}{\cmdudp@vb@width}
  \begin{actionenv}#3%
    \def\insertblocktitle{#2}%
    \par%
  \usebeamertemplate{block begin}
}{%
  \par%
  \usebeamertemplate{block end}%
  \end{actionenv}
  \end{minipage}
  \endgroup
}

% Example varblock
\newenvironment<>{examplevarblock}[2][]{
\begin{varblock}[titlefg=block title example.fg,titlebg=block title example.bg,bodybg=white,#1]{#2}
}{
\end{varblock}
}
